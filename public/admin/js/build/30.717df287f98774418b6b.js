(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{"/dv1":function(t,e,a){"use strict";a("PTLV")},CcSq:function(t,e,a){"use strict";a.r(e);var s=a("ySu/").a,i=(a("/dv1"),a("KHd+")),r=Object(i.a)(s,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"subheader",attrs:{id:"subheader"}},[e("div",{staticClass:"container"},[e("div",{staticClass:"subheader__main"},[e("h3",{staticClass:"subheader__title"},[t._v(t._s(t.$t("LBL_MESSAGES")))])])])]),t._v(" "),e("div",{staticClass:"container"},[e("div",{staticClass:"row chat"},[e("div",{staticClass:"col-lg-4 chat__aside",attrs:{id:"chat_aside","data-close-on-click-outside":"chat_aside"}},[e("div",{staticClass:"portlet portlet--last portlet--height-fluid"},[e("div",{staticClass:"portlet__body"},[t._m(0),t._v(" "),e("div",{staticClass:"searchbar"},[e("div",{staticClass:"form-group"},[e("div",{staticClass:"input-icon input-icon--left"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"text",placeholder:t.$t("PLH_SEARCH_CHAT"),id:"generalSearch"},domProps:{value:t.search},on:{keyup:t.searchRecords,input:function(e){e.target.composing||(t.search=e.target.value)}}}),t._v(" "),t._m(1)])])]),t._v(" "),e("perfect-scrollbar",{style:"max-height: 500px",attrs:{options:{suppressScrollX:!0}},on:{scroll:t.onScrollChat}},[e("div",{staticClass:"widget widget--users"},[t.chatThreads.length>0?e("div",{staticClass:"widget__items"},t._l(t.chatThreads,(function(a,s){return e("div",{key:s,staticClass:"widget__item",class:[t.adminsData.threadId==a.thread_id?"is-active":""],on:{click:function(e){return t.threadMessages(e,a)}}},[e("span",{staticClass:"media media--circle"},[e("img",{attrs:{src:t.$getFileUrl("userProfileImage",a.thread_started_by,0,"50-50"),width:"50"}}),t._v(" "),a.get_admin_unread_message_count>0?e("i",{staticClass:"badge badge--success",attrs:{id:"threadMessage-"+a.thread_id}},[t._v("\n                                                "+t._s(a.get_admin_unread_message_count)+"\n                                            ")]):t._e()]),t._v(" "),e("div",{staticClass:"widget__info"},[e("div",{staticClass:"widget__section"},[e("a",{staticClass:"widget__username",attrs:{href:"#"}},[t._v(t._s(a.user_fname+" "+a.user_lname))])]),t._v(" "),e("div",{staticClass:"widget__subject"}),t._v(" "),null!=a.message_text?e("span",{staticClass:"widget__desc"},[t._v("\n                                                    "+t._s(a.message_text.length>100?a.message_text.substring(0,50)+"....":a.message_text)+"\n                                                ")]):t._e()]),t._v(" "),e("div",{staticClass:"widget__action"},[e("div",{staticClass:"widget__date"},[e("span",[t._v("\n                                                "+t._s(t._f("formatDate")(a.message_created_at)))]),t._v(" "),e("span",{staticClass:"widget__time"},[t._v(t._s(t._f("formatTime")(a.message_created_at))+"\n                                            ")])])])])})),0):t._e(),t._v(" "),t.loading?e("loader"):t._e(),t._v(" "),0==t.loading&&0==t.chatThreads.length?e("noRecordsFound"):t._e()],1)])],1)])]),t._v(" "),e("div",{staticClass:"col-lg-12 col-xl-8 chat__content",attrs:{id:"chat_content"}},[e("div",{staticClass:"portlet portlet--head-lg"},[e("div",{staticClass:"portlet__head"},[e("div",{staticClass:"chat__head"},[e("div",{staticClass:"chat__center"},[e("ul",{staticClass:"list-group list-cart list-cart-order list-order list-order-return my-5"},[e("li",{staticClass:"list-group-item"},[e("div",{staticClass:"list-inner"},[e("div",{staticClass:"product-profile",staticStyle:{"max-width":"unset"}},[e("div",{staticClass:"product-profile__thumbnail"},[""!=t.thread_product_id?e("a",{attrs:{href:t.baseUrl+"/product/"+t.thread_product_id,target:"_blank"}},[""!=t.thread_product_variant?e("img",{staticClass:"pro-img img-fluid",attrs:{src:t.$productImage(t.thread_product_id,t.thread_product_variant,"","39-52")}}):e("img",{staticClass:"pro-img img-fluid",attrs:{src:t.$productImage(t.thread_product_id,0,"","39-52")}})]):t._e()]),t._v(" "),e("div",{staticClass:"product-profile__data text-left"},[""!=t.productName?e("div",{staticClass:"title"},[e("a",{staticClass:"text-body",attrs:{href:t.baseUrl+"/product/"+t.thread_product_id,target:"_blank"}},[t._v(t._s(t.productName))])]):t._e(),t._v(" "),""!=t.thread_subject?e("div",{staticClass:"sub__title"},[e("strong",[t._v(t._s(t.$t("LBL_MESSAGE_SUBJECT"))+": ")]),t._v(t._s(t.thread_subject)+" ")]):t._e()])])])])])])])]),t._v(" "),e("div",{staticClass:"portlet__body pb-0"},[e("div",{staticClass:"chat__messages",attrs:{id:"admin-chat-messages"}},[e("perfect-scrollbar",{ref:"scroll",style:"max-height: 370px; min-height: 370px;",attrs:{options:{suppressScrollX:!0},id:"YK-message-container"}},t._l(t.messages,(function(a,s){return e("div",{key:a.message_id,staticClass:"chat__message"},[0==a.message_from_admin?e("div",{staticClass:"msg"},[e("div",{staticClass:"chat__user"},[e("span",{staticClass:"media media--circle media--sm"},[e("img",{attrs:{src:t.$getFileUrl("userProfileImage",a.message_from_id,0,"60-60"),width:"60"}})])]),t._v(" "),e("div",{staticClass:"chat_text_wrapper"},[e("div",{staticClass:"chat__text"},[a.upload_images?e("img",{attrs:{src:t.$getFileUrl("messageFile",a.message_id,0,"original",""),width:"200"},on:{click:function(e){return t.openImage(a.message_id)}}}):e("p",[t._v(t._s(a.message_text))]),t._v(" "),e("p",{staticClass:"chat__datetime time__chat"},[t._v(t._s(t._f("formatTime")(a.message_created_at))+" ")])]),t._v(" "),e("p",{staticClass:"chat__datetime"},[t._v(t._s(t._f("formatDateTime")(a.message_created_at))+" ")])])]):t._e(),t._v(" "),1==a.message_from_admin?e("div",{staticClass:"msg"},[e("div",{staticClass:"chat__message chat__message--right"},[e("div",{staticClass:"chat_text_wrapper"},[e("div",{staticClass:"chat__text"},[a.upload_images?e("img",{attrs:{src:t.$getFileUrl("messageFile",a.message_id,0,"original",""),width:"200"},on:{click:function(e){return t.openImage(a.message_id)}}}):e("p",[t._v(t._s(a.message_text))])]),t._v(" "),e("p",{staticClass:"chat__datetime"},[t._v(t._s(t._f("formatDateTime")(a.message_created_at))+" ")])]),t._v(" "),e("div",{staticClass:"chat__user"},[e("span",{staticClass:"media media--circle media--sm"},[e("img",{attrs:{src:t.baseUrl+"/"+t.$getFileUrl("favicon",0,0,"38-38")}})])])])]):t._e()])})),0)],1)]),t._v(" "),e("div",{staticClass:"portlet__foot p-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.adminsData.threadId,expression:"adminsData.threadId"}],attrs:{type:"hidden"},domProps:{value:t.adminsData.threadId},on:{input:function(e){e.target.composing||t.$set(t.adminsData,"threadId",e.target.value)}}}),t._v(" "),e("div",{staticClass:"chat__input"},[e("div",{staticClass:"chat__editor"},[e("div",{staticClass:"chat__emoji"},[e("twemoji-picker",{attrs:{emojiData:t.emojiDataAll,emojiGroups:t.emojiGroups,pickerWidth:"300px",pickerCloseOnClickaway:!0},on:{emojiUnicodeAdded:t.selectEmoji},scopedSlots:t._u([{key:"twemoji-picker-button",fn:function(){return[e("button",{staticClass:"btn btn-lg emoji-icn"},[e("svg",{staticStyle:{"enable-background":"new 0 0 512 512"},attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",height:"16",version:"1.1",id:"Capa_1",x:"0px",y:"0px",viewBox:"0 0 512 512","xml:space":"preserve"}},[e("g",[e("g",[e("path",{attrs:{d:"M437.02,74.98C388.667,26.629,324.38,0,256,0S123.333,26.629,74.98,74.98C26.629,123.333,0,187.62,0,256    s26.629,132.668,74.98,181.02C123.333,485.371,187.62,512,256,512s132.667-26.629,181.02-74.98    C485.371,388.668,512,324.38,512,256S485.371,123.333,437.02,74.98z M256,472c-119.103,0-216-96.897-216-216S136.897,40,256,40    s216,96.897,216,216S375.103,472,256,472z"}})])]),t._v(" "),e("g",[e("g",[e("path",{attrs:{d:"M368.993,285.776c-0.072,0.214-7.298,21.626-25.02,42.393C321.419,354.599,292.628,368,258.4,368    c-34.475,0-64.195-13.561-88.333-40.303c-18.92-20.962-27.272-42.54-27.33-42.691l-37.475,13.99    c0.42,1.122,10.533,27.792,34.013,54.273C171.022,389.074,212.215,408,258.4,408c46.412,0,86.904-19.076,117.099-55.166    c22.318-26.675,31.165-53.55,31.531-54.681L368.993,285.776z"}})])]),t._v(" "),e("g",[e("g",[e("circle",{attrs:{cx:"168",cy:"180.12",r:"32"}})])]),t._v(" "),e("g",[e("g",[e("circle",{attrs:{cx:"344",cy:"180.12",r:"32"}})])])])])]},proxy:!0}])})],1),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.adminsData.txtMessage,expression:"adminsData.txtMessage"}],staticClass:"form-control",staticStyle:{height:"50px"},attrs:{id:"txtmessage",placeholder:t.$t("PLH_TYPE_HERE")+"..."},domProps:{value:t.adminsData.txtMessage},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:void e.preventDefault()},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:e.shiftKey?e.ctrlKey||e.altKey||e.metaKey?null:t.newline.apply(null,arguments):null}],keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:t.sendMessage.apply(null,arguments)},input:function(e){e.target.composing||t.$set(t.adminsData,"txtMessage",e.target.value)}}}),t._v(" "),e("div",{staticClass:"chat__send"},[e("div",{staticClass:"chat__image",class:[t.$canWrite("MESSAGES")?"":"disabledbutton"]},[e("label",{staticClass:"btn btn-lg mb-0",attrs:{id:"images"},on:{click:function(e){return t.$refs.fileInput.click()}}},[e("svg",{staticStyle:{"enable-background":"new 0 0 550.801 550.8"},attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",id:"Capa_1",x:"0px",y:"0px",width:"16px",height:"16px",viewBox:"0 0 550.801 550.8","xml:space":"preserve"}},[e("g",[e("path",{attrs:{d:"M515.828,61.201H34.972C15.659,61.201,0,76.859,0,96.172v358.458C0,473.942,15.659,489.6,34.972,489.6h480.856   c19.314,0,34.973-15.658,34.973-34.971V96.172C550.801,76.859,535.143,61.201,515.828,61.201z M515.828,96.172V350.51l-68.92-62.66   c-10.359-9.416-26.289-9.04-36.186,0.866l-69.752,69.741L203.438,194.179c-10.396-12.415-29.438-12.537-39.99-0.271L34.972,343.219   V96.172H515.828z M367.201,187.972c0-26.561,21.523-48.086,48.084-48.086c26.562,0,48.086,21.525,48.086,48.086   c0,26.561-21.523,48.085-48.086,48.085C388.725,236.058,367.201,214.533,367.201,187.972z"}})])])]),t._v(" "),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/x-png,image/gif,image/jpeg"},on:{change:t.fileSelected}})]),t._v(" "),e("div",{staticClass:"chat__action"},[e("button",{staticClass:"btn btn-brand btn-lg chat-send",class:[t.$canWrite("MESSAGES")?"":"disabledbutton"],attrs:{disabled:!t.isComplete||1==t.clicked},on:{click:t.sendMessage}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","enable-background":"new 0 0 24 24",height:"16",viewBox:"0 0 24 24",width:"16"}},[e("path",{attrs:{d:"m8.75 17.612v4.638c0 .324.208.611.516.713.077.025.156.037.234.037.234 0 .46-.11.604-.306l2.713-3.692z"}}),t._v(" "),e("path",{attrs:{d:"m23.685.139c-.23-.163-.532-.185-.782-.054l-22.5 11.75c-.266.139-.423.423-.401.722.023.3.222.556.505.653l6.255 2.138 13.321-11.39-10.308 12.419 10.483 3.583c.078.026.16.04.242.04.136 0 .271-.037.39-.109.19-.116.319-.311.352-.53l2.75-18.5c.041-.28-.077-.558-.307-.722z"}})])])])])])])])])])])])])}),[function(){var t=this._self._c;return t("button",{staticClass:"btn btn-outline-brand btn-elevate btn-icon btn-sm app__aside-close d-flex d-lg-none mb-3",attrs:{id:"chat_aside_close","data-target-close":"chat_aside"}},[t("i",{staticClass:"fas fa-times"})])},function(){var t=this._self._c;return t("span",{staticClass:"input-icon__icon input-icon__icon--left"},[t("span",[t("i",{staticClass:"la la-search"})])])}],!1,null,"0bebf1c6",null);e.default=r.exports},PTLV:function(t,e,a){var s=a("V6JQ");"string"==typeof s&&(s=[[t.i,s,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(s,i);s.locals&&(t.exports=s.locals)},V6JQ:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,"\n.emoji-list[data-v-0bebf1c6]{\n   background: red !important;\n}\n\n",""])},"ySu/":function(t,e,a){"use strict";(function(t,s){var i=a("rSMY"),r=a("NO+3"),n=(a("5xkF"),a("QzAy"),a("DQhr"));function c(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}var o={txtMessage:"",threadId:""};e.a={components:{"twemoji-picker":i.a},data:function(){return{baseUrl:baseUrl,messages:[],adminsData:o,chatThreads:[],search:"",user_name:"",thread_subject:"",productName:"",thread_product_id:"",thread_product_variant:"",clicked:0,logo:siteLogo,loading:!1,threadsRow:0,threadPending:0,threadPaginateCount:0,selectedFile:"",loadingData:!1}},methods:{newline:function(){this.value="".concat(this.value,"\n")},sendMessage:function(){var e=this;if(""==this.adminsData.txtMessage)return!1;this.clicked=1;var a=this.adminsData,i=this.$serializeData(a);this.$http.post(adminBaseUrl+"/messages/send-message",i).then((function(a){if(0==a.data.status)return t.error(a.data.message,"",t.options),void(e.clicked=0);1==a.data.status&&(e.adminsData.txtMessage="",e.messages.push(a.data.data),e.clicked=0,setTimeout((function(){s("#YK-message-container").scrollTop(s("#YK-message-container")[0].scrollHeight)}),500))}),(function(t){e.clicked=0}))},validateErrors:function(t){var e=this,a=t.data;Object.keys(a.errors).forEach((function(t){e.errors.add({field:t,msg:a.errors[t][0]})}))},searchRecords:function(){this.getChatThreads()},getChatThreads:function(){var e=this,a=this.$serializeData({total:0,search:this.search});this.$http.post(adminBaseUrl+"/messages/chat-threads",a).then((function(a){e.loading=!1,0!=a.data.status?e.chatThreads=a.data.data.message:t.error(a.data.message,"",t.options)}))},threadMessages:function(t,e){t.preventDefault(),this.thread_subject=e.thread_subject,this.thread_product_id=e.thread_product_id,this.productName=e.prod_name,this.thread_product_variant=e.thread_product_variant,this.$router.push({name:"threadMessages",params:{id:e.thread_id}}),setTimeout((function(){s("#YK-message-container").scrollTop(s("#YK-message-container")[0].scrollHeight),s("#threadMessage-"+e.thread_id).text("")}),500)},getMessageThreadData:function(){var e=this;this.$http.get(adminBaseUrl+"/messages/get-thread-messages/"+this.$route.params.id).then((function(a){0!=a.data.status?(e.messages=a.data.data,e.thread_subject=e.messages[0].thread.thread_subject,e.thread_product_id=e.messages[0].thread.product.prod_id,e.productName=e.messages[0].thread.product.prod_name,e.user_name=e.messages[0].message_from.user_fname+" "+e.messages[0].message_from.user_lname,a.data.data.length>0&&(e.adminsData.threadId=a.data.data[0].message_thread_id),setTimeout((function(){s("#YK-message-container").scrollTop(s("#YK-message-container")[0].scrollHeight)}),500)):t.error(a.data.message,"",t.options)}))},onScrollChat:function(t){var e=t.target;e.scrollTop+e.clientHeight+100>=e.scrollHeight&&!1===this.loading&&""==this.search&&this.infiniteHandler()},selectEmoji:function(t){this.adminsData.txtMessage+=t},fileSelected:function(t){t.preventDefault();var e=t.target.files[0].name;if(!/(\.jpg|\.jpeg|\.png|\.gif)$/i.exec(e))return alert(this.$t("NOTI_INVALID_FILE_TYPE")),!1;this.selectedFile=t.target.files[0],this.uploadImage()},uploadImage:function(){var e=this,a=this.adminsData,i=this.$serializeData(a);i.append("file",this.selectedFile),i.append("txtMessage",this.selectedFile.name),this.$http.post(adminBaseUrl+"/messages/send-message",i).then((function(a){if(0==a.data.status)return t.error(a.data.message,"",t.options),void(e.clicked=0);e.$refs.fileInput.value="",e.adminsData.txtMessage="",e.messages.push(a.data.data),setTimeout((function(){s("#YK-message-container").scrollTop(s("#YK-message-container")[0].scrollHeight)}),500),e.clicked=0}),(function(t){e.clicked=0}))},infiniteHandler:function(){var e=this;this.loading=!0;var a=this.$serializeData({total:this.chatThreads.length,page:this.page,search:this.search});this.$http.post(adminBaseUrl+"/messages/chat-threads",a).then((function(a){var s;(e.loading=!1,0!=a.data.status)?a.data.data.message.length&&((s=e.chatThreads).push.apply(s,c(a.data.data.message)),void 0!==e.chatThreads[0]&&""==e.search&&(e.thread_subject=e.chatThreads[0].thread_subject,e.thread_product_id=e.chatThreads[0].thread_product_id,e.productName=e.chatThreads[0].prod_name,e.thread_product_variant=e.chatThreads[0].thread_product_variant)):t.error(a.data.message,"",t.options)}))},openImage:function(t){var e=baseUrl+"/"+this.$getFileUrl("messageFile",t,0,"thumb");window.open(e)}},computed:{isComplete:function(){return this.adminsData.txtMessage.trim()},emojiDataAll:function(){return r},emojiGroups:function(){return n}},mounted:function(){var t=this.$route.params.id;this.adminsData.threadId=t,this.getMessageThreadData(),this.getChatThreads()},watch:{$route:"getMessageThreadData"}}}).call(this,a("hUol"),a("EVdn"))}}]);